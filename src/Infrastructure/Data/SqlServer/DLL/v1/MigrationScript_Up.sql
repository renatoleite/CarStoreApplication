USE [SQL_CAR_STORE]
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[CAR] (
	COD_CAR INT IDENTITY(1,1) NOT NULL,
	COD_CORRELATION UNIQUEIDENTIFIER NOT NULL,
	DSC_MODEL VARCHAR(255) NOT NULL,
	DSC_BRAND VARCHAR(255) NOT NULL,
	NUM_YEAR INT NOT NULL,
	COD_USER_INC INT NOT NULL,
	DAT_INC DATETIME2 NOT NULL,
	COD_USER_UPD INT NOT NULL,
	DAT_UPD DATETIME2 NOT NULL
)
GO

ALTER TABLE [dbo].[CAR] ADD CONSTRAINT PK_CAR PRIMARY KEY (COD_CAR)
GO

ALTER TABLE [dbo].[CAR] ADD CONSTRAINT DF_CAR_DAT_INC DEFAULT GETUTCDATE() FOR DAT_INC
GO

ALTER TABLE [dbo].[CAR] ADD CONSTRAINT DF_CAR_DAT_UPD DEFAULT GETUTCDATE() FOR DAT_UPD
GO

CREATE TABLE [dbo].[LOGIN] (
	COD_LOGIN INT IDENTITY(1,1) NOT NULL,
	NAM_USER VARCHAR(255) NOT NULL,
	PWD_USER VARCHAR(255) NOT NULL,
	DSC_ALLOW_ENDPOINTS VARCHAR(255),
	DAT_INC DATETIME2 NOT NULL
)
GO

ALTER TABLE [dbo].[LOGIN] ADD CONSTRAINT PK_LOGIN PRIMARY KEY (COD_LOGIN)
GO

ALTER TABLE [dbo].[LOGIN] ADD CONSTRAINT DF_LOGIN_DAT_INC DEFAULT GETUTCDATE() FOR DAT_INC
GO

ALTER TABLE [dbo].[CAR] ADD CONSTRAINT PK_CAR_LOGIN FOREIGN KEY (COD_USER_INC) REFERENCES [dbo].[LOGIN].[COD_LOGIN]
GO

---------- SEED ----------

-- credentials: admin / 123456
INSERT INTO [dbo].[LOGIN] (NAM_USER, PWD_USER, DSC_ALLOW_ENDPOINTS) VALUES ('admin', '8d969eef6ecad3c29a3a629280e686cf0c3f5d5a86aff3ca12020c923adc6c92', 'create;read;update;delete')
GO

INSERT INTO [dbo].[CAR] (COD_CORRELATION, DSC_MODEL, DSC_BRAND, NUM_YEAR, COD_USER_INC, COD_USER_UPD) VALUES (NEWID(), 'Civic', 'Honda', 2019, 1, 1)
GO

INSERT INTO [dbo].[CAR] (COD_CORRELATION, DSC_MODEL, DSC_BRAND, NUM_YEAR, COD_USER_INC, COD_USER_UPD) VALUES (NEWID(), 'Golf', 'Volkswagen', 2014, 1, 1)
GO